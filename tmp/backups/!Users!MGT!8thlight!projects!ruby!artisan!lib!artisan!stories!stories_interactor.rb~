require "artisan/backlog"
require "artisan/stories/stories_crud_strategy"

module Artisan
  module Stories
    class StoriesInteractor
      include StoriesCrudStrategy

      def initialize(project)
        @project = project
      end

      def backlog(filter_tag = nil)
        backlog_stories = filtered(filter_tag, @project.stories.backlog)
        return Backlog.new(backlog_stories)
      end

      def completed
        @project.stories.complete
      end

      private #################

      def filtered(filter_tag, stories)
        return stories if filter_tag.nil?
        return stories.tagged_with(filter_tag, :on => :tags)
      end

    end
  end
end
