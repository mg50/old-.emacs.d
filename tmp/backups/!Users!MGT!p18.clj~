

(def merge-rows [b a]
  (let [lower (butlast b),
        upper (rest b)]
    (map #(max (+ %1 %2) (+ %1 %3)) a lower upper)))

(def p18 [rows]
  (loop [rows (reverse rows)]
    (if-let [fst (first rows), snd (second rows)]
      (recur (cons (merge-rows fst snd) (rrest rows)))
      fst)))
