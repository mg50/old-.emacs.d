namespace('Abacus.Models', {
  Project: Backbone.RelationalModel.extend({
    urlRoot: '/projects',

    getCompanyList: function() {
      return App.companyList;
    },

    getCompanyName: function() {
      var companyList = this.getCompanyList(); 
      var company = _.find(companyList, function(company) {
       return company.id === this.get('company_id'); 
      }, this);
      
      var companyName = company ? company.name : "";

      return companyName;
    },

    relations: [{
      type: Backbone.HasMany,
      key: 'project_note',
      includeInJSON: false,
      relatedModel: Abacus.Models.ProjectNote,
      collectionType: Abacus.Collections.ProjectNotes,
      reverseRelation: {
        type: Backbone.HasOne,
        key: 'project',
        includeInJSON: false
      }
    },
    {
      type: Backbone.HasOne,
      key: 'company',
      includeInJSON: false,
      relatedModel: Abacus.Models.Company,
      collectionType: Abacus.Collections.Companies,
      reverseRelation: {
        type: Backbone.HasMany,
        key: 'projects',
        includeInJSON: false
      }
    }]
  })
});
