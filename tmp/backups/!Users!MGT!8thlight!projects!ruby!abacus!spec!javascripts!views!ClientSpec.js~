describe("Abacus.Views.Client", function() {
  beforeEach(function() {
    Abacus.Models.Project.prototype.getClientList = function() {
      return [{id: 5, name: 'IBM'}]
    }
    loadFixtures('_client.html', '_project.html');
    this.model = new Abacus.Models.Client({
      id: 5, 
      name: 'IBM',
      projects: [{
        name: 'p1',
        id: 1
      },
      {
        name: 'p2',
        id: 2
      }]
    });
    this.view = new Abacus.Views.Client({model: this.model});
  });

  describe("events", function() {
    it("anchor tag href is '#/client/{{id}}'", function() {
      this.view.render();
      var href = this.view.$('a.client').attr('href');
      expect(href).toBe('#/client/' + this.model.get('id'));
    });
  });

  describe("rendering", function() {
    it("renders the related projects along with the client", function() {
      sinon.spy(this.view, 'childViews');
      this.view.render(); 
      expect(this.view.childViews).toHaveBeenCalled();
      expect(this.view.$('.projects li').length).toBe(2);
    })
  })
});
